<local:JedenViewBase x:Class="MVVMFirma.Views.AnalizaPrzychodowProjektowView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
                     xmlns:local="clr-namespace:MVVMFirma.Views"
                     mc:Ignorable="d"
                     d:DesignHeight="800"
                     d:DesignWidth="1000">

    <Grid Background="#F4F4F4">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Nagłówek -->
        <TextBlock Text="Analiza Przychodów wg Projektów i Pracowników"
                   FontSize="32"
                   FontWeight="Bold"
                   Foreground="#232625"
                   HorizontalAlignment="Center"
                   Margin="20"
                   Grid.Row="0"
                   Grid.ColumnSpan="2" />

        <!-- Wybór miesiąca i roku -->
        <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="2" HorizontalAlignment="Center" Margin="20">
            <TextBlock Text="Miesiąc:"
                       FontSize="16"
                       FontWeight="Bold"
                       Foreground="#232625"
                       VerticalAlignment="Center"
                       Margin="5,0" />
            <ComboBox ItemsSource="{Binding Months}" 
                      SelectedItem="{Binding SelectedMonth, 
                      Mode=TwoWay}" 
                      Width="150" 
                      Margin="10,0" />

            <TextBlock Text="Rok:"
                       FontSize="16"
                       FontWeight="Bold"
                       Foreground="#232625"
                       VerticalAlignment="Center"
                       Margin="10,0" />
            <ComboBox ItemsSource="{Binding Years}" 
                      SelectedItem="{Binding SelectedYear, 
                      Mode=TwoWay}" 
                      Width="100" 
                      Margin="10,0" />

            <Button Content="Zastosuj"
                    Command="{Binding LoadDataCommand}"
                    FontSize="16"
                    FontWeight="Bold"
                    Padding="8,4"
                    Margin="20,0"
                    Width="150"
                    Cursor="Hand"
                    HorizontalAlignment="Center">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Background" Value="#4C594F" />
                        <Setter Property="Foreground" Value="White" />
                        <Setter Property="BorderBrush" Value="#4C594F" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            CornerRadius="8"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}">
                                        <ContentPresenter HorizontalAlignment="Center" 
                                                          VerticalAlignment="Center" />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#6A7F6D" />
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>

        </StackPanel>

        <!-- Komunikat o braku danych -->
        <StackPanel Orientation="Horizontal" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Center" Margin="20">

            <TextBlock Text="Brak danych dla wybranego miesiąca i roku."
                       FontSize="20"
                       FontWeight="Bold"
                       Foreground="Gray"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding HasData}" Value="False">
                                <Setter Property="Visibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </StackPanel>
        
        <!-- Nagłówek dla wykresu kołowego -->
        <TextBlock Text="Przychody projektów"
                   FontSize="20"
                   FontWeight="Bold"
                   Foreground="#232625"
                   HorizontalAlignment="Center"
                   Margin="10"
                   Grid.Row="3"
                   Grid.Column="0" />

        <!-- Wykres kołowy -->
        <lvc:PieChart Grid.Row="4" Grid.Column="0" Margin="10" Background="WhiteSmoke" Visibility="{Binding HasData}">
            <lvc:PieChart.Series>
                <lvc:PieSeries 
                    Title="{Binding ProjectNames}" 
                    Values="{Binding ProjectRevenues}" 
                    Fill="#4C594F" 
                    LabelPoint="{Binding PieLabelFormatter}" />
            </lvc:PieChart.Series>
        </lvc:PieChart>
        
        <!-- Nagłówek dla wykresu słupkowego -->
        <TextBlock Text="Projekty przypisane do pracowników"
                   FontSize="20"
                   FontWeight="Bold"
                   Foreground="#232625"
                   HorizontalAlignment="Center"
                   Margin="10"
                   Grid.Row="3"
                   Grid.Column="1" />

        <!-- Wykres kolumnowy -->
        <lvc:CartesianChart Grid.Row="4" Grid.Column="1" Margin="10" Background="WhiteSmoke" Visibility="{Binding HasData}">
            <lvc:CartesianChart.Series>
                <lvc:ColumnSeries Title="Liczba projektów" Values="{Binding EmployeeProjectCounts}" Fill="#A4A69C" />
            </lvc:CartesianChart.Series>
            <lvc:CartesianChart.AxisX>
                <lvc:Axis Title="Pracownicy" Labels="{Binding EmployeeNames}" Foreground="#232625" />
            </lvc:CartesianChart.AxisX>
            <lvc:CartesianChart.AxisY>
                <lvc:Axis Title="Liczba projektów" Foreground="#232625" />
            </lvc:CartesianChart.AxisY>
        </lvc:CartesianChart>

        <!-- Szczegółowe rekordy -->
        <StackPanel Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" Margin="10">
            <TextBlock Text="Szczegółowe dane projektów"
                       FontSize="18"
                       FontWeight="Bold"
                       Foreground="#232625"
                       Margin="5" />
            <DataGrid ItemsSource="{Binding ProjectDetails}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      Background="WhiteSmoke"
                      Foreground="#232625">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Nazwa projektu" Binding="{Binding ProjectName}" Width="*" />
                    <DataGridTextColumn Header="Klient" Binding="{Binding ClientsCompanyName}" Width="*" />
                    <DataGridTextColumn Header="Typ projektu" Binding="{Binding ProjectType}" Width="*" />
                    <DataGridTextColumn Header="Budżet (PLN)" Binding="{Binding ProjectBudget}" Width="*" />
                    <DataGridTemplateColumn Header="Menadżer" Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0} {1}">
                                            <Binding Path="EmployeesFirstName" />
                                            <Binding Path="EmployeesLastName" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
    </Grid>
</local:JedenViewBase>
